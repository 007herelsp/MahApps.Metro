<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:Controls="clr-namespace:MahApps.Metro.Controls">
  
  
  <Style TargetType="{x:Type Controls:NumericUpDown}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Controls:NumericUpDown}">
          <ControlTemplate.Resources>
            <Color x:Key="RangeReachedColor">OrangeRed</Color>
            <Storyboard x:Key="MinMaxReached">
              <ColorAnimation AutoReverse="True" 
                              Duration="00:00:00.1" 
                              Storyboard.TargetName="PART_TextBox" 
                              Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" To="{StaticResource RangeReachedColor}" />
            </Storyboard>
          </ControlTemplate.Resources>
          <ControlTemplate.Triggers>
            <EventTrigger RoutedEvent="MaximumReached">
              <EventTrigger.Actions>
                <BeginStoryboard Storyboard="{StaticResource MinMaxReached}" />
              </EventTrigger.Actions>
            </EventTrigger>
            <EventTrigger RoutedEvent="MinimumReached">
              <EventTrigger.Actions>
                <BeginStoryboard Storyboard="{StaticResource MinMaxReached}" />
              </EventTrigger.Actions>
            </EventTrigger>
          </ControlTemplate.Triggers>
          <Grid Background="{TemplateBinding Background}">
            <Grid.ColumnDefinitions>
              <ColumnDefinition />
              <ColumnDefinition Width="20" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition />
              <RowDefinition />
            </Grid.RowDefinitions>
            <TextBox x:Name="PART_TextBox" 
                     Grid.RowSpan="2" 
                     VerticalAlignment="Stretch" 
                     VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" 
                     Background="Transparent" 
                     TextAlignment="Right" />
            <RepeatButton x:Name="PART_NumericUp" 
                          Grid.Row="0" 
                          Grid.Column="1" 
                          Background="{TemplateBinding Background}" 
                          Delay="{TemplateBinding Delay}">
              <Polygon Margin="4,0" 
                       Fill="{TemplateBinding Foreground}" 
                       Points="3,0 6,6 0,6 3,0" 
                       Stroke="{TemplateBinding Foreground}" />
            </RepeatButton>
            <RepeatButton x:Name="PART_NumericDown" 
                          Grid.Row="1" 
                          Grid.Column="1" 
                          Background="{TemplateBinding Background}" 
                          Delay="{TemplateBinding Delay}" >
              <Polygon Margin="4,0" 
                       Fill="{TemplateBinding Foreground}" 
                       Points="3,6 6,0 0,0 3,6" 
                       Stroke="{TemplateBinding Foreground}" />
            </RepeatButton>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
</ResourceDictionary>